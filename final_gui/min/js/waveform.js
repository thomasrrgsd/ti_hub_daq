var chartFG=generateFGChart(),channelFG=0,freqFG=[5,5,5,5],ampFG=[1,1,1,1],dacfreqFG=1024,typeFG=[0,0,0,0],biasFG=[1,1,1,1];function generateFGChart(){return new Chart(document.getElementById("idealChart").getContext("2d"),{type:"line",data:{datasets:[{pointStyle:"line",label:"Ideal voltage",data:[],steppedLine:!1,fill:!1,borderColor:"rgb(14, 173, 105)"}]},options:{plugins:{zoom:{pan:{enabled:!0,mode:"x"},zoom:{enabled:!0,mode:"x"}}},title:{display:!0,text:"Waveform",fontColor:"rgb(255, 255, 255)"},legend:{display:!1,labels:{defaultFontFamily:"'Roboto', 'Franklin Gothic Medium', 'Tahoma', 'sans-serif",fontColor:"rgb(255, 255, 255)"}},color:"rgb(255, 255, 255)",scales:{yAxes:[{gridLines:{drawOnChartArea:!0,color:"rgb(255,255,255)"},ticks:{fontColor:"rgb(255, 255, 255)",beginAtZero:!0,callback:function(e,a,n){return e+" V"}},scaleLabel:{display:!0,labelString:"Voltage"},type:"linear"}],xAxes:[{ticks:{fontColor:"rgb(255, 255, 255)",beginAtZero:!0,callback:function(e,a,n){return e+"s"}},scaleLabel:{display:!0,labelString:"Time"},type:"linear"}]}}})}function trimNum(e){return Math.round(e*10**7)/10**7}function setIdealChart(e,a,n,t,c){data=[];var l=n>e?n/e:n;switch(t){case 0:for(e<1&&(l=n/e),cycleLength=trimNum(1/e),i=0;i<l;i++)sec=trimNum(i/n),cycleCount=Math.floor(trimNum(sec/cycleLength)),sec-=cycleCount*cycleLength,sec<=cycleLength/2?data.push(c+a/2):data.push(c-a/2);break;case 1:for(dx=2*Math.PI*e/n,e<1&&(l=n/e,dx=2*Math.PI/l,console.log(l)),i=0;i<l;i++)data.push(a/2*Math.sin(i*dx)+c);break;case 2:for(dx=a/e,n>e&&(l=n,dx=a/l),e<1&&(l=n/e),cycleLength=trimNum(1/e),i=0;i<l;i++)sec=trimNum(i/l),cycleCount=Math.floor(trimNum(sec/cycleLength)),sec-=cycleCount*cycleLength,data.push(sec/cycleLength*a+c-a/2);break;case 3:for(l=n,i=0;i<l;i++)data.push(c)}for(chartFG.data.datasets[0].data=[],cycleIndex=0,length=Math.floor(e)==e?n:l;chartFG.data.datasets[0].data.length<=length;){for(i=0;i<l&&(chartFG.data.datasets[0].data.push({x:trimNum((cycleIndex*l+i)/n),y:trimNum(data[i])}),!(chartFG.data.datasets[0].data.length>length));i++);cycleIndex++}chartFG.update()}function resetZoom(){chartFG.resetZoom()}function updateFreqFG(){freqFG[channelFG]=document.getElementById("freqFG").value,freqFG[channelFG]=freqFG[channelFG]<=0?.01:freqFG[channelFG],document.getElementById("freq-input").value=freqFG[channelFG],setIdealChart(freqFG[channelFG],ampFG[channelFG],dacfreqFG,typeFG[channelFG],biasFG[channelFG]),sendCommand(17+channelFG,freqFG[channelFG])}function updateAmpFG(){ampFG[channelFG]=parseFloat(document.getElementById("ampFG").value),document.getElementById("amplitude-input-fg").value=ampFG[channelFG],setIdealChart(freqFG[channelFG],ampFG[channelFG],dacfreqFG,typeFG[channelFG],biasFG[channelFG]),sendCommand(13+channelFG,1e3*ampFG[channelFG])}function updateTypeFG(){typeFG[channelFG]=document.getElementById("typeFG").selectedIndex,setIdealChart(freqFG[channelFG],ampFG[channelFG],dacfreqFG,typeFG[channelFG],biasFG[channelFG]),sendCommand(9+channelFG,typeFG[channelFG])}function updateBiasFG(){biasFG[channelFG]=parseFloat(document.getElementById("biasFG").value),document.getElementById("bias-input").value=biasFG[channelFG],setIdealChart(freqFG[channelFG],ampFG[channelFG],dacfreqFG,typeFG[channelFG],biasFG[channelFG]),sendCommand(21+channelFG,1e3*biasFG[channelFG])}function changeChFG(){channelFG=document.getElementById("chFG").selectedIndex,document.getElementById("typeFG").selectedIndex=typeFG[channelFG],document.getElementById("freq-input").value=freqFG[channelFG],document.getElementById("amplitude-input-fg").value=ampFG[channelFG],document.getElementById("bias-input").value=biasFG[channelFG],setIdealChart(freqFG[channelFG],ampFG[channelFG],dacfreqFG,typeFG[channelFG],biasFG[channelFG])}function startFG(){switch(channelFG){case 0:sendCommand(5,1);break;case 1:sendCommand(6,1);break;case 2:sendCommand(7,1);break;case 3:sendCommand(8,1)}}function stopFG(){switch(channelFG){case 0:sendCommand(5,0);break;case 1:sendCommand(6,0);break;case 2:sendCommand(7,0);break;case 3:sendCommand(8,0)}}$(document).ready((function(){setIdealChart(freqFG[channelFG],ampFG[channelFG],dacfreqFG,typeFG[channelFG],biasFG[channelFG])}));